<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">



    <t t-name="onsp_co2.CarbonOriginPopover" owl="1">
        <div class="m-3">
            <h6>Value origin</h6>
            <div t-out="props.origin" />
        </div>
    </t>


    <t t-name="onsp_co2.CarbonSettings" owl="1">

        <div class="carbon_settings_main">
            <div class="o_horizontal_separator mt-4 mb-3 text-uppercase fw-bolder small">
                <t t-if="props.title" t-out="props.title" />
                <t t-else="">Carbon '<t t-out="props.type" />' settings</t>
            </div>

            <div class="row">
                <div class="btn-group col-6" role="group" aria-label="Settings mode" >
                    <button type="button"
                            data-mode="auto"
                            t-attf-class="btn #{getCarbonField('is_manual') ? 'btn-outline-secondary' : 'btn-outline-primary o_we_no_pointer_events active'}"
                            t-on-click="updateMode">
                        Auto
                    </button>
                    <button type="button"
                            data-mode="manual"
                            t-attf-class="btn #{!getCarbonField('is_manual') ? 'btn-outline-secondary' : 'btn-outline-primary o_we_no_pointer_events active'}"
                            t-on-click="updateMode">
                        Manual
                    </button>
                </div>

                <div class="btn-group col-6" role="group" aria-label="Compute method" t-attf-class="#{getCarbonField('is_manual') and getCarbonField('factor_id') === false ? '' : 'no_event opacity-50'}">
                    <button type="button" t-attf-class="btn btn-outline-secondary #{getCarbonField('compute_method') === 'monetary' ? 'active': 'opacity-75'} #{availableComputeMethods.includes('monetary') ? '' : 'no_event'}" t-on-click="updateMethod" data-method="monetary">
                        <i class="fa fa-money fa-fw mr-3" />
                        <span>Monetary</span>
                    </button>
                    <button type="button" t-attf-class="btn btn-outline-secondary #{getCarbonField('compute_method') === 'physical' ? 'active': 'opacity-75'} #{availableComputeMethods.includes('physical') ? '' : 'no_event'}" t-on-click="updateMethod" data-method="physical">
                        <i class="fa fa-balance-scale fa-fw mr-3" />
                        <span>Physical</span>
                    </button>
                </div>
            </div>


            <div class="row mt-3">
                <div class="col-3"><strong class="o_form_label">Value</strong></div>
                <div class="col-7">
                    <div class="row">
                        <div class="col-3"><FloatField readonly="!getCarbonField('is_manual') or getCarbonField('compute_method') == false or getCarbonField('factor_id') != false" record="props.record" value="getCarbonField('value')" name="getCarbonFieldFullName('value')" digits="[16, 4]" update="updateField" /></div>
                        <div class="col-3 p-0"><span t-out="props.record.data.carbon_currency_label" style="color: #A0A0A0;"/> /</div>

                        <div t-attf-class="o_cell o_wrap_input flex-grow-1 flex-sm-grow-0 text-break col-6">
                            <div t-if="getCarbonField('compute_method') === 'physical'" name="carbon_uom_id" class="o_field_widget o_field_many2one">
                                <Many2OneField readonly="!getCarbonField('is_manual') or getCarbonField('factor_id') != false" record="props.record" value="getCarbonField('uom_id')" name="getCarbonFieldFullName('uom_id')" update="updateField" />
                            </div>
                            <div t-elif="getCarbonField('compute_method') === 'monetary'" name="carbon_monetary_currency_id" class="o_field_widget o_field_many2one">
                                <Many2OneField readonly="!getCarbonField('is_manual') or getCarbonField('factor_id') != false" record="props.record" value="getCarbonField('monetary_currency_id')" name="getCarbonFieldFullName('monetary_currency_id')" update="updateField" />
                            </div>
                        </div>


                    </div>
                </div>
                <div class="col-2 p-0 m-0">
                    <button t-if="!getCarbonField('is_manual')" type="button" class="btn btn-secondary" t-on-click="showOrigin" title="See value origin">
                        <i class="fa fa-question-circle" />
                    </button>
                    <button t-if="!getCarbonField('is_manual')" type="button" class="btn btn-secondary" t-on-click="recomputeCarbon" title="Recompute carbon value">
                        <i class="fa fa-refresh" />
                    </button>
                </div>

            </div>

            <div class="row" t-if="getCarbonField('is_manual')">
                <div class="col-3"><strong class="o_form_label">Emission Factor</strong></div>
                <div class="col-9">
                    <div t-attf-class="o_cell o_wrap_input flex-grow-1 flex-sm-grow-0 text-break #{getCarbonField('is_manual') ? '' : 'display-none'}" style="width: 100%;">
                        <div name="carbon_factor_id" class="o_field_widget o_field_many2one col-10">
                            <Many2OneField readonly="!getCarbonField('is_manual')" record="props.record" value="getCarbonField('factor_id')" name="getCarbonFieldFullName('factor_id')" update="updateField"/>
                        </div>
                    </div>
                </div>
            </div>


        </div>

    </t>



</templates>
