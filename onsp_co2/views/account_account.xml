<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

        <record id="view_account_form" model="ir.ui.view">
            <field name="name">view_account_form</field>
            <field name="model">account.account</field>
            <field name="inherit_id" ref="account.view_account_form" />
            <field name="arch" type="xml">
                <xpath expr="//page[@name='accounting']" position="inside">
                    <group string="CO2 Settings" name="group_carbon_settings">

                        <group>
                            <field name="use_carbon_value" />
                        </group>

                        <group attrs="{'invisible': [('use_carbon_value', '=', False)]}">
                            <label for="carbon_in_is_manual" string="Mode" />
                            <div style="display: inline-flex; font-size: 1.15rem;" class="gap-1">
                                <div class="opacity-50 mr-2" attrs="{'invisible': [('carbon_in_is_manual', '!=', True)]}">Auto</div>
                                <div style="font-weight: bold;" attrs="{'invisible': [('carbon_in_is_manual', '=', True)]}">Auto</div>

                                <field name="carbon_in_is_manual" nolabel="1" widget="boolean_toggle" class="" style="margin-left: 8px;"/>
                                <field name="carbon_in_mode" invisible="1" />

                                <div class="opacity-50" attrs="{'invisible': [('carbon_in_is_manual', '=', True)]}">Manual</div>
                                <div style="font-weight: bold;" attrs="{'invisible': [('carbon_in_is_manual', '!=', True)]}">Manual</div>


                                <button type="object"
                                    name="action_recompute_carbon"
                                    icon="fa-refresh"
                                    context="{'carbon_type': 'carbon_in'}"
                                    title="Re-compute CO2e value"
                                    attrs="{'invisible': [('carbon_in_is_manual', '=', True)]}"
                                    confirm="Do you really want to re-compute the value?" />
                            </div>


                            <field name="carbon_in_compute_method" force_save="1"
                                   attrs="{
                                   'readonly': ['|', ('carbon_in_is_manual', '!=', True), ('carbon_in_factor_id', '!=', False)],
                                   'required': [('carbon_in_is_manual', '=', True)]
                                   }" />

                            <label for="carbon_in_value" string="Value" />
                            <div class="o_row">
                                <field name="carbon_in_value" class="oe_inline" force_save="1"
                                   attrs="{
                                   'invisible': [('carbon_in_compute_method', '=', False)],
                                   'required': [('carbon_in_compute_method', '!=', False)],
                                   'readonly': ['|', ('carbon_in_is_manual', '!=', True), ('carbon_in_factor_id', '!=', False)],
                                   }" />
                                <field name="carbon_currency_label" class="oe_inline" style="color: grey;"
                                        attrs="{'invisible': [('carbon_in_compute_method', '=', False)]}" />
                                <span class="oe_inline" attrs="{'invisible': [('carbon_in_compute_method', '=', False)],}">/</span>


                                <field name="carbon_in_uom_id" class="oe_inline" force_save="1"
                                       attrs="{
                                       'invisible': [('carbon_in_compute_method', '!=', 'physical')],
                                       'required': [('carbon_in_compute_method', '=', 'physical')],
                                       'readonly': ['|', ('carbon_in_is_manual', '!=', True), ('carbon_in_factor_id', '!=', False)],
                                       }" />
                                <field name="carbon_in_monetary_currency_id" class="oe_inline" force_save="1"
                                       attrs="{
                                       'invisible': [('carbon_in_compute_method', '!=', 'monetary')],
                                       'required': [('carbon_in_compute_method', '=', 'monetary')],
                                       'readonly': ['|', ('carbon_in_is_manual', '!=', True), ('carbon_in_factor_id', '!=', False)],
                                       }" />
                            </div>


                            <field name="carbon_in_factor_id" attrs="{'invisible': [('carbon_in_is_manual', '!=', True)]}" />
                            <field name="carbon_in_value_origin" force_save="1" attrs="{'invisible': [('carbon_in_is_manual', '=', True)]}" />

                        </group>


                    </group>
                </xpath>
            </field>
        </record>

    </data>
</odoo>
